<div th:fragment="component-input-fields-exclude" th:remove="tag">
  <template>
    <v-select
      @blur="save"
      v-model="states.items"
      :label="field.label"
      :hint="field.hint"
      :items="field.items"
      multiple
    >
    </v-select>
  </template>

  <script th:inline="javascript">
    DOM = document.getElementsByTagName("template")[0];
    DOM.remove();

    Vue.component("component-input-fields-exclude", {
      template: DOM.innerHTML.toString(),

      props: { path: String, inputType: String },
      data() {
        return {
          field: {
            label: "Exclude",
            hint: "Optionally removes the standard tools from the editor toolbar.",
            items: [
              "*",
              "Format",
              "Bold",
              "Italic",
              "Underline",
              "JustifyBlock",
              "JustifyLeft",
              "JustifyCenter",
              "JustifyRight",
              "BulletedList",
              "NumberedList",
              "Outdent",
              "Indent",
              "SpecialChar",
              "Anchor",
              "Image",
              "Macro",
              "Link",
              "Unlink",
              "Table",
              "PasteModeSwitcher",
              "BGColor",
              "Blockquote",
              "Copy",
              "CopyFormatting",
              "CreateDiv",
              "Cut",
              "Font",
              "FontSize",
              "HorizontalRule",
              "ListStyle",
              "NewPage",
              "Preview",
              "Redo",
              "RemoveFormat",
              "SelectAll",
              "Strike",
              "Styles",
              "Subscript",
              "Superscript",
              "TextColor",
              "Undo",
            ],
          },

          states: {
            items: [],
          },
        };
      },
      mounted() {
        this.states.items = this.value;
      },
      watch: {
        value() {
          this.states.items = this.value;
        },
      },
      methods: {
        save() {
          const path = `${this.path}.elements`;
          const data = [
            {
              type: "text",
              text: this.states.items.join(" "),
            },
          ];
          this.$store.commit("updateJson", { path, data });
        },
      },
      computed: {
        json() {
          return this.$store.getters.jsonPath(this.path);
        },
        value() {
          try {
            return _.get(this.json, "elements[0].text")
              .split(" ")
              .sort((a, b) => a.localeCompare(b));
          } catch (err) {
            return [];
          }
        },
      },
    });
  </script>
</div>
