<div th:fragment="component-input-fields-service" th:remove="tag">
  <template>
    <v-text-field
      @blur="save"
      v-model="states.text"
      :label="field.label"
      :hint="field.hint"
    >
    </v-text-field>
  </template>

  <script th:inline="javascript">
    DOM = document.getElementsByTagName("template")[0];
    DOM.remove();

    Vue.component("component-input-fields-service", {
      template: DOM.innerHTML.toString(),

      props: { path: String, inputType: String },
      data() {
        return {
          field: {
            label: "Service",
            hint: "Holds the name of a JavaScript service file, located under /resources/services/[my-custom-selector]/[my-custom-selector].js. You can also refer to a service file in another application, for example com.myapplication.app:myservice.",
          },

          states: {
            text: "",
          },
        };
      },
      mounted() {
        this.states.text = this.value;
      },
      watch: {
        value() {
          this.states.text = this.value;
        },
      },
      methods: {
        save() {
          const path = `${this.path}.elements`;
          const data = [
            {
              type: "text",
              text: this.states.text,
            },
          ];
          this.$store.commit("updateJson", { path, data });
        },
      },
      computed: {
        json() {
          return this.$store.getters.jsonPath(this.path);
        },
        value() {
          return _.get(this.json, "elements[0].text") || "";
        },
      },
    });
  </script>
</div>
